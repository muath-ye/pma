{"version":3,"file":"database/operations.js","mappings":"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","sources":["webpack://phpmyadmin/./resources/js/src/database/operations.ts","webpack://phpmyadmin/external var \"jQuery\""],"sourcesContent":["import $ from 'jquery';\nimport { AJAX } from '../modules/ajax.ts';\nimport { Functions } from '../modules/functions.ts';\nimport { Navigation } from '../modules/navigation.ts';\nimport { CommonParams } from '../modules/common.ts';\nimport { ajaxShowMessage } from '../modules/ajax-message.ts';\nimport getJsConfirmCommonParam from '../modules/functions/getJsConfirmCommonParam.ts';\nimport { escapeHtml } from '../modules/functions/escape.ts';\nimport refreshMainContent from '../modules/functions/refreshMainContent.ts';\n/**\n * @fileoverview    function used in server privilege pages\n * @name            Database Operations\n *\n * @requires    jQueryUI\n */\n/**\n * Ajax event handlers here for /database/operations\n *\n * Actions Ajaxified here:\n * Rename Database\n * Copy Database\n * Change Charset\n * Drop Database\n */\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('database/operations.js', function () {\n    $(document).off('submit', '#rename_db_form.ajax');\n    $(document).off('submit', '#copy_db_form.ajax');\n    $(document).off('submit', '#change_db_charset_form.ajax');\n    $(document).off('click', '#drop_db_anchor.ajax');\n});\nAJAX.registerOnload('database/operations.js', function () {\n    /**\n     * Ajax event handlers for 'Rename Database'\n     */\n    $(document).on('submit', '#rename_db_form.ajax', function (event) {\n        event.preventDefault();\n        if (Functions.emptyCheckTheField(this, 'newname')) {\n            ajaxShowMessage(window.Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n        var oldDbName = CommonParams.get('db');\n        var newDbName = $('#new_db_name').val();\n        if (newDbName === oldDbName) {\n            ajaxShowMessage(window.Messages.strDatabaseRenameToSameName, false, 'error');\n            return false;\n        }\n        var $form = $(this);\n        var question = escapeHtml('CREATE DATABASE ' + newDbName + ' / DROP DATABASE ' + oldDbName);\n        Functions.prepareForAjaxRequest($form);\n        $form.confirm(question, $form.attr('action'), function (url) {\n            ajaxShowMessage(window.Messages.strRenamingDatabases, false);\n            $.post(url, $('#rename_db_form').serialize() + CommonParams.get('arg_separator') + 'is_js_confirmed=1', function (data) {\n                if (typeof data !== 'undefined' && data.success === true) {\n                    ajaxShowMessage(data.message);\n                    Navigation.update(CommonParams.set('db', data.newname));\n                    Navigation.reload(function () {\n                        $('#pma_navigation_tree')\n                            .find('a:not(\\'.expander\\')')\n                            .each(function () {\n                            var $thisAnchor = $(this);\n                            if ($thisAnchor.text() === data.newname) {\n                                // simulate a click on the new db name\n                                // in navigation\n                                $thisAnchor.trigger('click');\n                            }\n                        });\n                    });\n                }\n                else {\n                    ajaxShowMessage(data.error, false);\n                }\n            }); // end $.post()\n        });\n    }); // end Rename Database\n    /**\n     * Ajax Event Handler for 'Copy Database'\n     */\n    $(document).on('submit', '#copy_db_form.ajax', function (event) {\n        event.preventDefault();\n        if (Functions.emptyCheckTheField(this, 'newname')) {\n            ajaxShowMessage(window.Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n        ajaxShowMessage(window.Messages.strCopyingDatabase, false);\n        var $form = $(this);\n        Functions.prepareForAjaxRequest($form);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            // use messages that stay on screen\n            $('.alert-success, .alert-danger').fadeOut();\n            if (typeof data !== 'undefined' && data.success === true) {\n                if ($('#checkbox_switch').is(':checked')) {\n                    Navigation.update(CommonParams.set('db', data.newname));\n                    refreshMainContent(false);\n                    AJAX.callback = () => {\n                        ajaxShowMessage(data.message);\n                    };\n                }\n                else {\n                    Navigation.update(CommonParams.set('db', data.db));\n                    ajaxShowMessage(data.message);\n                }\n                Navigation.reload();\n            }\n            else {\n                ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end copy database\n    /**\n     * Change tables columns visible only if change tables is checked\n     */\n    $('#span_change_all_tables_columns_collations').hide();\n    $('#checkbox_change_all_tables_collations').on('click', function () {\n        $('#span_change_all_tables_columns_collations').toggle();\n    });\n    /**\n     * Ajax Event handler for 'Change Charset' of the database\n     */\n    $(document).on('submit', '#change_db_charset_form.ajax', function (event) {\n        event.preventDefault();\n        var $form = $(this);\n        Functions.prepareForAjaxRequest($form);\n        ajaxShowMessage(window.Messages.strChangingCharset);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            if (typeof data !== 'undefined' && data.success === true) {\n                ajaxShowMessage(data.message);\n            }\n            else {\n                ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end change charset\n    /**\n     * Ajax event handlers for Drop Database\n     */\n    $(document).on('click', '#drop_db_anchor.ajax', function (event) {\n        event.preventDefault();\n        var $link = $(this);\n        /**\n         * @var {string} question String containing the question to be asked for confirmation\n         */\n        var question = window.Messages.strDropDatabaseStrongWarning + ' ';\n        question += window.sprintf(window.Messages.strDoYouReally, 'DROP DATABASE `' + escapeHtml(CommonParams.get('db') + '`'));\n        var params = getJsConfirmCommonParam(this, $link.getPostData());\n        $(this).confirm(question, $(this).attr('href'), function (url) {\n            ajaxShowMessage(window.Messages.strProcessingRequest);\n            $.post(url, params, function (data) {\n                if (typeof data !== 'undefined' && data.success) {\n                    // Database deleted successfully, refresh both the frames\n                    Navigation.reload();\n                    Navigation.update(CommonParams.set('db', ''));\n                    refreshMainContent('index.php?route=/server/databases');\n                    AJAX.callback = () => {\n                        ajaxShowMessage(data.message);\n                    };\n                }\n                else {\n                    ajaxShowMessage(data.error, false);\n                }\n            });\n        });\n    });\n});\n","module.exports = jQuery;"],"names":["$","AJAX","Functions","Navigation","CommonParams","ajaxShowMessage","getJsConfirmCommonParam","escapeHtml","refreshMainContent","registerTeardown","document","off","registerOnload","on","event","preventDefault","emptyCheckTheField","window","Messages","strFormEmpty","oldDbName","get","newDbName","val","strDatabaseRenameToSameName","$form","question","prepareForAjaxRequest","confirm","attr","url","strRenamingDatabases","post","serialize","data","success","message","update","set","newname","reload","find","each","$thisAnchor","text","trigger","error","strCopyingDatabase","fadeOut","is","callback","db","hide","toggle","strChangingCharset","$link","strDropDatabaseStrongWarning","sprintf","strDoYouReally","params","getPostData","strProcessingRequest"],"sourceRoot":""}